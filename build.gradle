plugins {
    id 'cpp'
    id 'java'
    id 'me.champeau.gradle.jmh' version '0.4.4'
}

group 'com.kjmrknsn.jnibench'
version '1.0-SNAPSHOT'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    jmh group: 'org.openjdk.jmh', name: 'jmh-core', version: '1.19'
    jmh group: 'org.openjdk.jmh', name: 'jmh-generator-annprocess', version: '1.19'
    jmh group: 'org.openjdk.jmh', name: 'jmh-generator-asm', version: '1.19'
    jmh group: 'org.openjdk.jmh', name: 'jmh-generator-bytecode', version: '1.19'
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

task generateJniHeaders(type:Exec) {
    commandLine "javah", "-d", "src/jmh/jni", "-classpath", "out/jmh/classes", "jnibench.Jni"
    dependsOn classes
}

jmh {
    jvmArgs = "-Djava.library.path=src/jmh/jni"
}
